return{filename="",file=nil,serialize=function(self,a)if not self.file then self.openWrite(self)end;io.write(self.file,"return ")self.serializeObject(self,a)self.closeFile(self)end,serializeObject=function(self,a)if type(a)=="number"then io.write(self.file,a)elseif type(a)=="string"then io.write(self.file,string.format("%q",a))elseif type(a)=="table"then io.write(self.file,"{")for b,c in pairs(a)do io.write(self.file,b,"=")self.serializeObject(self,c)io.write(self.file,",")end;io.write(self.file,"}")else error("cannot serialize a "..type(a))end end,openWrite=function(self)self.open(self,"w")end,openRead=function(self)self.open(self,"r")end,open=function(self,d)self.file=io.open(self.filename,d)end,closeFile=function(self)if self.file then io.close(self.file)end end}
